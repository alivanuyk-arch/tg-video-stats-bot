# üìä Telegram –±–æ—Ç –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –≤–∏–¥–µ–æ

–ì–∏–±—Ä–∏–¥–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞: **rule-based —à–∞–±–ª–æ–Ω—ã + LLM fallback**. –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –≤–æ–ø—Ä–æ—Å—ã –Ω–∞ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–º —è–∑—ã–∫–µ –≤ SQL –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∏—Ö –≤ —Ä–µ–∞–ª—å–Ω–æ–π –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –≤–∏–¥–µ–æ-—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏.

## üéØ –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

ü§ñ **–£–º–Ω–∞—è –≥–∏–±—Ä–∏–¥–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞**: Rule-based —à–∞–±–ª–æ–Ω—ã (15+) –¥–ª—è —Ç–∏–ø–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ + LLM (OLLAMA) –¥–ª—è —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö  
‚ö° **–ú–≥–Ω–æ–≤–µ–Ω–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å**: –ü—Ä–∞–≤–∏–ª–∞ —Ä–∞–±–æ—Ç–∞—é—Ç –±–µ–∑ LLM, –±—ã—Å—Ç—Ä–µ–µ –≤ 10+ —Ä–∞–∑  
üîí **–ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å**: –ö–æ–¥ –Ω–∞–¥—ë–∂–Ω–µ–µ LLM, –≤–∞–ª–∏–¥–∞—Ü–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ SQL  
üí¨ **–ü–æ–ª–Ω—ã–π Telegram –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å**: –ü—Ä–æ—Å—Ç—ã–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã  
üèéÔ∏è **–í—ã—Å–æ–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: PostgreSQL + –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞  
üß† **–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π LLM**: –¢–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ –Ω–µ—Ç –ø—Ä–∞–≤–∏–ª, —ç–∫–æ–Ω–æ–º–∏–º —Ç–æ–∫–µ–Ω—ã  

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ‚Üí Telegram Bot ‚Üí SimpleBot
‚îú‚îÄ‚îÄ –ü—Ä–∞–≤–∏–ª–∞ (80-90% –∑–∞–ø—Ä–æ—Å–æ–≤) ‚Üí SQL ‚Üí PostgreSQL
‚îî‚îÄ‚îÄ LLM fallback (10-20% –∑–∞–ø—Ä–æ—Å–æ–≤) ‚Üí Ollama ‚Üí SQL ‚Üí PostgreSQL

text

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
- **SimpleBot** ‚Äî Telegram –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Ç–æ–∫–∞–º–∏
- **LLMTeacher** ‚Äî Rule-based —à–∞–±–ª–æ–Ω—ã + LLM fallback —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º–∏  
- **DatabaseManager** ‚Äî –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å PostgreSQL —á–µ—Ä–µ–∑ asyncpg
- **Telegram Bot** ‚Äî –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ python-telegram-bot

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –í–∞—Ä–∏–∞–Ω—Ç 1: –¢–æ–ª—å–∫–æ –ë–î –≤ Docker (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
```bash
# 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone https://github.com/yourname/tg-video-stats-bot.git
cd tg-video-stats-bot

# 2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –æ–∫—Ä—É–∂–µ–Ω–∏–µ
cp .env.example .env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env: –¥–æ–±–∞–≤—å—Ç–µ TELEGRAM_TOKEN –æ—Ç @BotFather

# 3. –ó–∞–ø—É—Å—Ç–∏—Ç—å PostgreSQL –≤ Docker
docker-compose -f docker-compose.simple.yml up -d

# 4. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install -r requirements.txt

# 5. –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
python scripts/load_data.py

# 6. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å OLLAMA (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è fallback)
ollama pull mistral:7b-instruct

# 7. –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞
python simple_bot.py
–í–∞—Ä–∏–∞–Ω—Ç 2: –ü–æ–ª–Ω–æ—Å—Ç—å—é –ª–æ–∫–∞–ª—å–Ω–æ
bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ PostgreSQL
sudo apt install postgresql

# –°–æ–∑–¥–∞—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
sudo -u postgres psql -c "CREATE DATABASE video_analytics;"
sudo -u postgres psql -c "CREATE USER postgres WITH PASSWORD 'postgres123';"
sudo -u postgres psql -c "GRANT ALL PRIVILEGES ON DATABASE video_analytics TO postgres;"

# –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ö–µ–º—É
psql -d video_analytics -U postgres -f scripts/create_tables.sql

# –î–∞–ª—å—à–µ —à–∞–≥–∏ 2,4,5,6,7 –∏–∑ –≤–∞—Ä–∏–∞–Ω—Ç–∞ 1
üìñ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
–ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –±–æ—Ç—É:
text
–°–∫–æ–ª—å–∫–æ –≤—Å–µ–≥–æ –≤–∏–¥–µ–æ –≤ —Å–∏—Å—Ç–µ–º–µ?
–°–∫–æ–ª—å–∫–æ –≤–∏–¥–µ–æ —É –∫—Ä–µ–∞—Ç–æ—Ä–∞ —Å id aca1061a9d324ecf8c3fa2bb32d7be63?
–°–∫–æ–ª—å–∫–æ –≤–∏–¥–µ–æ –Ω–∞–±—Ä–∞–ª–∏ –±–æ–ª—å—à–µ 10 000 –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤?
–ù–∞ —Å–∫–æ–ª—å–∫–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤ –≤—ã—Ä–æ—Å–ª–∏ –≤–∏–¥–µ–æ —Å 10:00 –¥–æ 15:00 28 –Ω–æ—è–±—Ä—è 2025?
–°–∫–æ–ª—å–∫–æ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤?
–í —Å–∫–æ–ª—å–∫–∏—Ö –¥–Ω—è—Ö –Ω–æ—è–±—Ä—è 2025 –ø—É–±–ª–∏–∫–æ–≤–∞–ª –≤–∏–¥–µ–æ –∫—Ä–µ–∞—Ç–æ—Ä X?
–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:
–ü—Ä–æ—Å—Ç–æ –Ω–∞–ø–∏—à–∏—Ç–µ –≤–æ–ø—Ä–æ—Å –Ω–∞ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–º —è–∑—ã–∫–µ

–ë–æ—Ç –æ—Ç–≤–µ—Ç–∏—Ç —á–∏—Å–ª–æ–º (—Ä–µ–∑—É–ª—å—Ç–∞—Ç SQL –∑–∞–ø—Ä–æ—Å–∞)

üõ†Ô∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏
Rule-based —Å–∏—Å—Ç–µ–º–∞ (LLMTeacher)
15+ —à–∞–±–ª–æ–Ω–æ–≤ ‚Äî –ø–æ–∫—Ä—ã–≤–∞—é—Ç 80-90% —Ç–∏–ø–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã ‚Äî –±–æ–ª–µ–µ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –∏–º–µ—é—Ç –≤—ã—Å—à–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç

–û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä—É—Å—Å–∫–æ–≥–æ —è–∑—ã–∫–∞ ‚Äî —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –¥–∞—Ç, –º–µ—Å—è—Ü–µ–≤, —á–∏—Å–µ–ª

–ê–≤—Ç–æ–∫–æ—Ä—Ä–µ–∫—Ü–∏—è ‚Äî –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–∏–ø–æ–≤—ã—Ö –æ—à–∏–±–æ–∫ LLM

LLM Fallback
–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ø—Ä–æ–º–ø—Ç ‚Äî —Ç–æ–ª—å–∫–æ —Å—Ö–µ–º–∞ —Ç–∞–±–ª–∏—Ü, –±–µ–∑ –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∏

–ê–Ω–≥–ª–∏–π—Å–∫–∏–π —è–∑—ã–∫ ‚Äî —Å—Ç–∞–±–∏–ª—å–Ω–µ–µ –¥–ª—è –º–æ–¥–µ–ª–µ–π

–í–∞–ª–∏–¥–∞—Ü–∏—è ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ SQL –ø–µ—Ä–µ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ä–µ–¥–∫–æ ‚Äî —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ –Ω–µ—Ç –ø–æ–¥—Ö–æ–¥—è—â–µ–≥–æ –ø—Ä–∞–≤–∏–ª–∞

–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
PostgreSQL 15 ‚Äî –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

–°—Ö–µ–º–∞:

videos: –û—Å–Ω–æ–≤–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (id, creator_id, views_count, video_created_at)

video_snapshots: –ü–æ—á–∞—Å–æ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è (video_id, created_at, delta_views_count)

–ò–Ω–¥–µ–∫—Å—ã ‚Äî –Ω–∞ creator_id, video_created_at, created_at

üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
text
tg-video-stats-bot/
‚îú‚îÄ‚îÄ simple_bot.py          # –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª –∑–∞–ø—É—Å–∫–∞
‚îú‚îÄ‚îÄ src/                   # –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥
‚îÇ   ‚îú‚îÄ‚îÄ llm_fallback.py   # –ì–∏–±—Ä–∏–¥–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ (–ø—Ä–∞–≤–∏–ª–∞ + LLM)
‚îÇ   ‚îú‚îÄ‚îÄ database.py       # –†–∞–±–æ—Ç–∞ —Å PostgreSQL
‚îÇ   ‚îî‚îÄ‚îÄ config.py         # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ scripts/              # –°–∫—Ä–∏–ø—Ç—ã –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ create_tables.sql # –°—Ö–µ–º–∞ –ë–î
‚îÇ   ‚îî‚îÄ‚îÄ load_data.py      # –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ archive/              # Legacy –∫–æ–¥ (–∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä)
‚îú‚îÄ‚îÄ docker-compose.simple.yml
‚îú‚îÄ‚îÄ .env.example          # –®–∞–±–ª–æ–Ω –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ requirements.txt      # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Python
‚îî‚îÄ‚îÄ README.md            # –≠—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞
–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (.env):
env
# Telegram
TELEGRAM_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω_–±–æ—Ç–∞

# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö PostgreSQL
DB_HOST=localhost
DB_PORT=5432
DB_NAME=video_analytics
DB_USER=postgres
DB_PASSWORD=postgres123

# OLLAMA (–¥–ª—è fallback)
ENABLE_LLM=true
OLLAMA_MODEL=mistral:7b-instruct
OLLAMA_BASE_URL=http://localhost:11434

# –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
LOG_LEVEL=INFO
–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –º–æ–¥–µ–ª–∏ OLLAMA:
mistral:7b-instruct (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

llama3.2:3b

phi:2.7b

‚ö° –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
–ü—Ä–∞–≤–∏–ª–∞ vs LLM ‚Äî –ø—Ä–∞–≤–∏–ª–∞ –≤ 100+ —Ä–∞–∑ –±—ã—Å—Ç—Ä–µ–µ

PostgreSQL ‚Äî –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å ‚Äî –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –Ω–µ–±–ª–æ–∫–∏—Ä—É—é—â–∏–µ

–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π LLM ‚Äî —ç–∫–æ–Ω–æ–º–∏—è —Ç–æ–∫–µ–Ω–æ–≤, —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å

üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è
MIT

ü§ù –í–∫–ª–∞–¥ –≤ –ø—Ä–æ–µ–∫—Ç
–§–æ—Ä–∫–Ω–∏—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π

–°–æ–∑–¥–∞–π—Ç–µ –≤–µ—Ç–∫—É –¥–ª—è –Ω–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

–ó–∞–∫–æ–º–º–∏—Ç—å—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

–û—Ç–ø—Ä–∞–≤—å—Ç–µ Pull Request

üêõ –ü–æ–¥–¥–µ—Ä–∂–∫–∞
–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ PostgreSQL –∑–∞–ø—É—â–µ–Ω

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ .env —Ñ–∞–π–ª–µ

–î–ª—è LLM: —É–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ OLLAMA –∑–∞–ø—É—â–µ–Ω (ollama serve)

–ë–æ—Ç –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ! –ó–∞–¥–∞–≤–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å—ã –Ω–∞ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–º —è–∑—ã–∫–µ –∏ –ø–æ–ª—É—á–∞–π—Ç–µ –∞–Ω–∞–ª–∏—Ç–∏–∫—É –ø–æ –≤–∏–¥–µ–æ-—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ.